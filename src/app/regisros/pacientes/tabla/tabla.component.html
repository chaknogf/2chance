<div class="">
  <div class="">
    <form class="d-flex justify-content-center align-items-center gap-1" autocomplete="off" >
      <input type="text" class="form-control bg-opacity-75 text-center expande-contenido" name="expediente" placeholder="Expediente" [(ngModel)]="expedienteBuscar" />
      <input type="text" class="form-control text-center text-capitalize expande-contenido" placeholder="Nombre" name="nombreBuscar" [(ngModel)]="nombreBuscar" />
      <input type="text" class="form-control text-center text-capitalize expande-contenido" placeholder="Apellido" name="apellidoBuscar" [(ngModel)]="apellidoBuscar" />
      <input type="text" class="form-control text-center expande-contenido" placeholder="DPI" name="dpiBuscar" [(ngModel)]="dpiBuscar" />
      <button type="submit" class="btn btn-quatz"  (click)="filtro()">buscar</button>
      <button type="submit" class="btn border-quatz " (click)="limpiarInput()"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eraser-fill" viewBox="0 0 16 16">
        <path d="M8.086 2.207a2 2 0 0 1 2.828 0l3.879 3.879a2 2 0 0 1 0 2.828l-5.5 5.5A2
         2 0 0 1 7.879 15H5.12a2 2 0 0 1-1.414-.586l-2.5-2.5a2 2 0 0 1 0-2.828l6.879-6.879zm.66
          11.34L3.453 8.254 1.914 9.793a1 1 0 0 0 0 1.414l2.5 2.5a1 1 0 0 0 .707.293H7.88a1 1 0 0 0 .707-.293l.16-.16z"/>
      </svg></button>
      <button class="btn btn-info bg-black  w-auto p-0" data-bs-toggle="modal" data-bs-target="#formularioModalP">Crear Paciente</button>
    </form>
  </div>

  <div class="mt-3">
    <div class=" ">
      <!-- <table class="table table-hover table-black table-borderless fs-5 " aria-labelledby="tableLabel" *ngIf="pacientes.length > 0"> -->
      <table class="table table-hover table-black">
        <thead class="">
          <tr>

            <th class="text-center ">in</th>
            <th class="text-center ">in</th>
            <th class="text-center " >Exp </th>
            <th class="text-center " >Nombre</th>
            <th class="text-center " >DPI</th>
            <th class="text-center " >Sexo</th>
            <th class="text-center " >Edad</th>
            <th class="text-center " >Estado</th>

        </tr>
        </thead>

        <tbody class="justify-content-center text-normal  ">
          <tr *ngFor="let paciente of filteredPacientes">

            <td>
              <button *ngIf="paciente.sexo === 'F' && calcularEdad(paciente.nacimiento) > 10" class="btn btn-dark btn-sm" [routerLink]="['/rn/', paciente.expediente]">
                <svg fill="#000000" height="24px" width="24px" version="1.1" fill="currentColor" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                viewBox="0 0 480 480" xml:space="preserve">
                <path id="XMLID_819_" d="M251,90c0-5.523,4.477-10,10-10h2c5.523,0,10,4.477,10,10s-4.477,10-10,10h-2
               C255.477,100,251,95.523,251,90z M217,100h2c5.523,0,10-4.477,10-10s-4.477-10-10-10h-2c-5.523,0-10,4.477-10,10
               S211.477,100,217,100z M480,200v250c0,16.542-13.458,30-30,30H30c-16.542,0-30-13.458-30-30V200c0-16.542,13.458-30,30-30h42.57
               c6.191-17.461,22.874-30,42.43-30h10c3.895,0,7.676,0.498,11.283,1.432c-0.166-1.054-0.316-2.112-0.45-3.173
               C126.569,134.596,120,125.551,120,115c0-12.376,9.04-22.681,20.864-24.658C154.356,51.713,189.38,24.367,230,20.477V10
               c0-5.523,4.477-10,10-10s10,4.477,10,10v10.477c40.62,3.89,75.644,31.236,89.136,69.865C350.96,92.319,360,102.624,360,115
               c0,10.551-6.569,19.596-15.833,23.259c-0.134,1.061-0.284,2.119-0.45,3.173C347.324,140.498,351.105,140,355,140h10
               c19.556,0,36.239,12.539,42.43,30H450C466.542,170,480,183.458,480,200z M334.651,170.492c-1,2.078-2.943,4.216-4.359,10.684
               c-0.017,0.079-0.289,2.612-0.292,3.764c0,0.003,0,0.005,0,0.008c0,0.006,0,0.012,0,0.018c0,0.011,0,0.022,0,0.033
               c0,13.785,11.215,25,25,25h10c13.785,0,25-11.215,25-25c0-1.114-0.073-2.21-0.215-3.286c-0.032-0.186-0.059-0.374-0.081-0.563
               C387.848,169.187,377.477,160,365,160h-10C346.62,160,339.189,164.145,334.651,170.492z M140,115c0,2.757,2.243,5,5,5h0.131
               c5.322,0,9.711,4.168,9.986,9.482c0.562,10.837,3.182,21.381,7.683,31.125c1.504,2.323,4.665,8.728,5.081,9.393h25.283
               c-7.24-7.51-12.734-16.8-15.699-27.277c-1.504-5.314,1.585-10.841,6.899-12.345c5.315-1.505,10.841,1.585,12.345,6.899
               C202.162,156.544,219.963,170,240,170s37.838-13.456,43.29-32.723c1.504-5.314,7.033-8.402,12.345-6.899
               c5.314,1.503,8.403,7.031,6.899,12.345c-2.965,10.478-8.458,19.768-15.699,27.277h25.283c0.416-0.666,3.577-7.07,5.081-9.393
               c4.501-9.743,7.121-20.288,7.683-31.125c0.275-5.314,4.665-9.482,9.986-9.482H335c2.757,0,5-2.243,5-5s-2.243-5-5-5h-3.331
               c-4.512,0-8.465-3.021-9.649-7.375c-9.15-33.627-38.008-58.006-72.037-62.037C249.678,45.837,245.325,50,240,50
               s-9.678-4.163-9.983-9.412c-34.029,4.031-62.887,28.41-72.037,62.037c-1.185,4.354-5.138,7.375-9.649,7.375H145
               C142.243,110,140,112.243,140,115z M90,185c0,13.785,11.215,25,25,25h10c13.785,0,25-11.215,25-25c0-0.011,0-0.022,0-0.033
               c0-0.006,0-0.012,0-0.018c0-0.003,0-0.005,0-0.008c-0.003-1.152-1-8.524-4.651-14.448C140.811,164.145,133.38,160,125,160h-10
               c-12.477,0-22.848,9.187-24.704,21.151C90.274,181.34,90,183.886,90,185z M460,200c0-5.514-4.486-10-10-10h-40.276
               c-2.496,22.468-21.601,40-44.724,40h-10c-23.123,0-42.229-17.532-44.724-40H169.724c-2.496,22.468-21.601,40-44.724,40h-10
               c-23.123,0-42.229-17.532-44.724-40H30c-5.514,0-10,4.486-10,10v250c0,5.514,4.486,10,10,10h420c5.514,0,10-4.486,10-10V200z
                M416.5,275c-5.523,0-10,4.477-10,10v20c0,11.028-8.972,20-20,20s-20-8.972-20-20v-20c0-5.523-4.477-10-10-10s-10,4.477-10,10v20
               c0,18.604,12.767,34.283,30,38.734V365c0,5.523,4.477,10,10,10s10-4.477,10-10v-21.266c17.233-4.451,30-20.13,30-38.734v-20
               C426.5,279.477,422.023,275,416.5,275z M231.5,315v50c0,5.523-4.477,10-10,10s-10-4.477-10-10v-20h-40v20c0,5.523-4.477,10-10,10
               s-10-4.477-10-10v-50c0-22.056,17.944-40,40-40S231.5,292.944,231.5,315z M211.5,315c0-11.028-8.972-20-20-20s-20,8.972-20,20v10h40
               V315z M133.5,345c0,16.542-13.458,30-30,30h-40c-5.523,0-10-4.477-10-10v-80c0-5.523,4.477-10,10-10h30c16.542,0,30,13.458,30,30
               c0,5.345-1.404,10.367-3.865,14.718C127.967,325.054,133.5,334.393,133.5,345z M73.5,315h20c5.514,0,10-4.486,10-10s-4.486-10-10-10
               h-20V315z M113.5,345c0-5.514-4.486-10-10-10h-30v20h30C109.014,355,113.5,350.514,113.5,345z M334.5,345c0,16.542-13.458,30-30,30
               h-40c-5.523,0-10-4.477-10-10v-80c0-5.523,4.477-10,10-10h30c16.542,0,30,13.458,30,30c0,5.345-1.404,10.367-3.865,14.718
               C328.967,325.054,334.5,334.393,334.5,345z M274.5,315h20c5.514,0,10-4.486,10-10s-4.486-10-10-10h-20V315z M314.5,345
               c0-5.514-4.486-10-10-10h-30v20h30C310.014,355,314.5,350.514,314.5,345z"/>
                 </svg>
              </button>
          </td>

          <td>
            <button *ngIf="paciente?.depto && paciente?.municipio && paciente?.sexo && paciente?.telefono" class="btn btn-dark btn-sm" (click)="copiarId(paciente.expediente, paciente.nombre, paciente.apellido, paciente.nacimiento, paciente.sexo, paciente.direccion, paciente.telefono)" data-bs-toggle="modal" data-bs-target="#formularioCrear" >
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-clipboard2-plus-fill" viewBox="0 0 16 16">
                <path d="M10 .5a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5.5.5 0 0 1-.5.5.5.5 0 0 0-.5.5V2a.5.5 0 0 0 .5.5h5A.5.5 0 0 0 11 2v-.5a.5.5 0 0
                0-.5-.5.5.5 0 0 1-.5-.5Z"/>
                <path d="M4.085 1H3.5A1.5 1.5 0 0 0 2 2.5v12A1.5 1.5 0 0 0 3.5 16h9a1.5 1.5 0 0 0 1.5-1.5v-12A1.5 1.5 0 0 0 12.5 1h-.585c.055.156.085.325.085.5V2a1.5
                1.5 0 0 1-1.5 1.5h-5A1.5 1.5 0 0 1 4 2v-.5c0-.175.03-.344.085-.5ZM8.5 6.5V8H10a.5.5 0 0 1 0 1H8.5v1.5a.5.5 0 0 1-1 0V9H6a.5.5 0 0 1 0-1h1.5V6.5a.5.5 0 0 1 1 0Z"/>
              </svg>
            </button>

          </td>

          <td class="h3 text-center text-success" (click)="abrirModal(paciente)" data-bs-toggle="modal" data-bs-target="#ver" >validar {{ paciente.expediente }}</td>

          <td class="text-center text-justify" appHighlightWords >
            <span class="font-fam">Nombre:</span> {{ paciente.nombre | capitalizeName }}<br>
            <span class="font-fam">Apellido:</span> {{ paciente.apellido | capitalizeName }}
          </td>

          <td class="text-center">{{ paciente.dpi | anyToText | formatoDPI }}</td>


          <td class="text-center">{{ paciente.sexo }}</td>

          <td class="text-center" #edadCell>{{ paciente.nacimiento | edad }}</td>

          <td class="text-center">{{ paciente.estado }}</td>


          </tr>
        </tbody>
      </table>
    </div>



  <!-- Paginación -->
    <div class="d-flex justify-content-center pagination mt-3">
      <div class="btn-group" [class.disabled]="paginaActual === 1" *ngIf="totalPaginas()">
        <button type="button" class="btn btn-secondary" (click)="onPageChange(1)" aria-label="Primera">Primera</button>
        <button type="button" class="btn btn-secondary" (click)="onPageChange(paginaActual - 1)" aria-label="Anterior">Anterior</button>
        <button type="button" class="btn btn-secondary" (click)="onPageChange(paginaActual + 1)" aria-label="Siguiente">Siguiente</button>
        <button type="button" class="btn btn-secondary" (click)="onPageChange(totalPaginas())" aria-label="Última">Última</button>
      </div>
    </div>
  </div>
  </div>

  <div class="modal" id="formularioModalP">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Modal title</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
            <span aria-hidden="true"></span>
          </button>
        </div>
        <div class="modal-body">
      <formulario-paciente></formulario-paciente>
        </div>
        <div class="modal-footer">
          <!-- <button type="button" class="btn btn-primary">Save changes</button>
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button> -->
        </div>
      </div>
    </div>
  </div>

  <div class="modal" id="formularioCrear">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header d-flex justify-content-center">
          <h5 class="modal-title textx-center">Registrar consulta externa</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
            <span aria-hidden="true"></span>
          </button>
        </div>
        <div class="modal-body">
          <div>
            <form class="form-group">

              <div class="form-group">
                <label for="especialidad">Especialidad:</label>
                <select id="especialidad" class="form-control" [(ngModel)]="coex.especialidad" name="especialidad" >
                  <option class="bg-dark" *ngFor="let option of e.servicio" [value]="option.value">{{ option.label }}</option>
                </select>
              </div>

              <div class="form-group">
                <label for="expediente">Expediente:</label>
                <input type="text" class="form-control" id="expediente" name="expediente"  [(ngModel)]='coex.expediente'  >
              </div>

              <div class="form-group">
                <p>{{coex.nombres}} {{coex.apellidos}}</p>
              </div>







            </form>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" (click)="registrarCoex()"  >Guardar</button>
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
        </div>
      </div>
    </div>
  </div>


  <div class="modal" id="formulario2">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
       <!--  -->
       <div class="form-group">
        <input type="text" class="form-control" id="nombre" name="nombre"  [(ngModel)]='coex.nombres' placeholder="nombres" disabled="">
        <input type="text" class="form-control" id="apellido" name="apellido" [(ngModel)]="coex.apellidos" placeholder="apellidos" disabled="">
        <input type="date" class="form-control" id="fecha_consulta" name="fecha_consulta" [(ngModel)]="coex.fecha_consulta" placeholder="fecha de consulta" disabled="">
        <input type="time" class="form-control" id="hora" name="hora" [(ngModel)]="coex.hora" placeholder="hora" disabled="">
        <input type="text" class="form.control" id="edad" name="edad" [(ngModel)]="coex.edad" placeholder="edad" value="paciente.nacimiento" disabled="">
        <input type="text" class="form-control" id="nacimiento" name="nacimiento" [(ngModel)]="coex.nacimiento" placeholder="fecha de nacimiento" disabled="">
      </div>


      </div>
    </div>
  </div>



  <div class="modal" id="ver">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content w-80 p-1 bg-info bg-opacity-50">
        <div class="modal-header">
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
            <span aria-hidden="true"></span>
          </button>
        </div>
        <div class="modal-body">
          <div class="">
            <div class=" h4 text-center">
              Detalle del Paciente expediente: <strong>{{ patient?.expediente }}</strong><br>
              Id: {{ patient?.id }}
            </div>
            <div class=" w-100 mx-5 font-monospace text-body-secondary">
              <hr>
              <strong class="h5 me-3">Nombres:</strong> {{ patient?.nombre | anyToText | capitalizeName }}<br>
              <strong class="h5 me-3">Apellidos:</strong> {{ patient?.apellido | anyToText | capitalizeName }}<br>
              <strong class="h5 me-3">Nacimiento:</strong> {{ patient?.nacimiento | anyToText | formatoFecha }}<br>
              <strong class="h5 me-3">Edad:</strong> {{ patient?.nacimiento | edad }}<br>
              <strong class="h5 me-3">Sexo:</strong> {{ patient?.sexo | anyToText | sexo }}<br>
              <strong class="h5 me-3">DPI:</strong> {{ patient?.dpi | anyToText | formatoDPI }}<br>
              <strong class="h5 me-3">Dirección:</strong> {{ patient?.direccion | anyToText | capitalizeName }}, {{patient?.municipio | anyToNumber | enumMunicipio}}, {{patient?.depto | anyToNumber | enumDepto}}<br>
              <strong class="h5 me-3">Teléfono:</strong> {{ patient?.telefono }}<br>
              <strong class="h5">Teléfono de Familiar / responsable:</strong> {{ patient?.telefono_responsable }}<br>
              <strong class="h5 me-3">Responsable:</strong> {{ patient?.responsable | anyToText | capitalizeName }}<br>
              <strong class="h5 me-3">Parentesco:</strong> {{ patient?.parentesco | anyToNumber | enumParentesco }}<br>


              <button class="btn btn-dark btn-sm" [routerLink]="['/paciente/edit', patient?.id]" data-bs-dismiss="modal" aria-label="Close">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil-square" viewBox="0 0 16 16">
                  <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/>
                  <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"/>
                </svg>Actualizar
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
